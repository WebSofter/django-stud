## Информация по запуску проекта

Проект можно запускать, как в ручном режиме, так и в Docker. Предполагается, что пользователь запускает данный проект на ОС Linux(Ubuntu/Debian). Для запуска на остальных системах надо будет использовать соответствующие стили команд для инструментов.

Стек проекта:

1. Django - используется, как основной фреймворк
2. Для верстки используется Bootstrap 5
3. Для придания визуальной привлекательности используются свободные UI компоненты в составе [Material Dashboard](https://github.com/creativetimofficial/material-dashboard)
4. Для развертывания можно воспользоваться тремя способами:

   - мануально через утилиту виртуального окружения venv
   - мануально через менеджер пакетов conda
   - автоматом через виртуализацию docker
5. На данный момент проект запущен по адресу [https://medstat.skillka.ru]() на виртуальном сервере(VDS) у хостинг-провайдера firstvds.ru
6. Для просмотра БД в составе Docker сервисов имеется PhpMyAdmin, настроенный на запуск на порту [http://medstat.skillka.ru:8090]() с данными:

   - Логин: `medstat`
   - Пароль:  `secret`

### Подготовка исходников

1. Открываем папку проекта в редакторе
2. Подготавливаем `.env` - файл. Для этого копируем и переименовываем `.env.example` в `.env` в корне проекта и меняем под свои потребности настрйоки, если необходимо.

### Запуск в ручном режиме

**_предупреждение:_** При запуске проекта в ручном режиме без Docker необходимо, чтобы в системе был установлен сервер БД.

1. В первую очередь нам потребуется в системе `Python3.10` и выше и в терминале должна выполняться команда `python3 --version` и поставить в систему зависимости. Для Ubuntu/Debian данная процедура будет выглядеть так

```bash
$ apt-get install gcc default-libmysqlclient-dev pkg-config -y
```

2. Далее нам потребуется создать виртуальнео окружение для проекта, чтобы не засорять систему модулями проекта. Создать виртуальнео окружение можно, как с помощью утилиты `venv`, так и с помощью менеджера пакетов `conda`.

   2.1. Создание виртуального окружение через `venv`

   ```bash
   $ python3 -m venv medstat
   $ source ./medstat/bin/activate
   ```

   2.2. Создание через менеджер пакетов `conda`
   В первую очередь необходимо установить зависимости для Conda для систем Ubuntu/Debian

   ```bash
   conda install -c conda-forge gcc=12.1.0
   ```

   далее создаем виртуальнео окружение и активируем

   ```bash
   $ conda -n medstat
   $ conda activate medstat
   ```
3. Ставим зависимости

   ```bash
   $ pip install -r requirements.txt
   ```
4. Инициализируем и мигрируем БД

   ```bash
   $ python manage.py makemigrations
   $ python manage.py migrate
   ```
5. Создаем суперюзера

   ```bash
   $ python manage.py createsuperuser
   ```
6. Запускаем приложение

   ```bash
   $ python manage.py runserver
   ```

   эта команда выведет хост и порт, по которому запустилось приложенеи `http://127.0.0.1:8000/`

### Запуск через Docker

Для запуска в контейнере Docker необходимо, чтобы в системе был устанволен сервис Docker с официального сайта. Конкретные шаги установки для конкретных ОС можно почитать на офф-сайте http://docker.com. Для поднятия проекта в контейнера выполняем команду

```bash
    $ docker compose up -d  
```

    данная команда прочитает инструкции из файла`docker-compose.yml`, поднимет все нужные сервисы, сделает миграции и запустит проект на порту `localhost:8000`.

### Вход в PhpMyAdmin

Составе проекта Docker имеется сервис клиента БД PhpMyAdmin, который имеет следующие параметры для входа:

- `localhost:3306` или `http://medstat.skillka.ru` - адрес входа
- `medstat` или `root` - пользователь БД
- `secret` - пароль БД

### Изменение стилей SCSS (необязательно)

Стили интерфейса кастомизируются через SCSS файл и необходимо перекомпилировать, если требуется применять. Для этого в папке static настроен проект с компилятор gulp и исходниками.
Для запуска компилятора необходимо наличие на операционнйо системе

- `Node` v16.15.0
- `Yarn` 1.22.18
- `Gulp` CLI version: `2.3.0`, Local version: `4.0.2`

А чтобы выполнить сборку, нужно:

```bash
$ cd static
$ npm i                                        # Ставим модули
$ nano scss/material-dashboard/_variables.scss # Меняем нужные параметры
$ npm run build                                # Делаем сборку   
```

### Общая структура проекта

Проект имеет следующую общую структуру:

```bash
   |
   |-- core/                             # Проект
   |    |-- settings.py                  # Конфигурация  
   |    |-- urls.py                      # Маршрутизация
   |
   |-- home/                             # Приложение:Главная
   |    |-- views.py                     # Виды
   |    |-- urls.py                      # Маршруты
   |    |-- models.py                    # Модели
   |    |-- tests.py                     # Тесты
   |    |-- templates/                   # Кастомные шаблоны
   |         |-- includes                # 
   |              |-- custom-footer.py   # Кастомный футер
   |
   |-- dashboard/                        # Приложение:Дашбоард
   |     |
   |     |-- templates/                  # Шаблоны
   |          |  
   |          |-- accounts/   
   |          |    |-- login.html        # Страница входа
   |          |    |-- register.html     # Страница регистрации
   |          |
   |          |-- includes/   
   |          |    |-- footer.html       # Компонент фцтера
   |          |    |-- sidebar.html      # Компонент колонки
   |          |    |-- navigation.html   # Компонент навигации
   |          |    |-- scripts.html      # Компонент скриптов
   |          |
   |          |-- layouts/   
   |          |    |-- base.html         # Схема общих страниц
   |          |    |-- base-auth.html    # Схема страниц авторизации
   |          |
   |          |-- pages/   
   |               |-- index.html        # Страница дашбоарда
   |               |-- profile.html      # Страница профиля
   |               |-- *.html            # Все остальные страницы
   |  
   |   
   |-- requirements.txt                  # Зависимости проекта
   |
   |-- env.example                       # Параметры проекта
   |-- manage.py                         # Скрипт запуска проекта
   |
```

### Работа с языковыми файлами

Перевод шаблона основан на встроенной функциональнсоти Django по формату i18n. Будут полезными несколько команд для работы с переводом шабонов внтури приложений

1. Добавление языкового файла

```bash
$ cd app
$ mkdir makedir locale
$ django-admin makemessages -l ru
```

2. Обновление языкового файла

```bash
$ django-admin makemessages -a -s --ignore=venv
```

3. Компиляция языкового файла

```bash
$ django-admin compilemessages --ignore=venv
```
